<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .quiz-container {
            max-width: 600px;
            width: 90%;
        }
        /* Custom styles for preserving newlines */
        .preserve-whitespace {
            white-space: pre-wrap;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen">

    <div id="quiz-container" class="quiz-container bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 md:p-8 transition-all duration-300">

        <!-- Start Screen -->
        <div id="start-screen" class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 dark:text-white mb-4">Welcome to the Quiz!</h1>
            <p class="text-gray-600 dark:text-gray-300 mb-8">Click the button below to test your knowledge.</p>
            <button id="start-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-300 dark:focus:ring-indigo-800">Start Quiz</button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <div class="mb-6">
                <p class="text-sm text-gray-500 dark:text-gray-400">Question <span id="question-number"></span> of <span id="total-questions"></span></p>
                <h2 id="question-text" class="text-xl md:text-2xl font-semibold text-gray-800 dark:text-white mt-2 preserve-whitespace"></h2>
            </div>

            <div id="options-container" class="space-y-3">
                <!-- Options will be dynamically inserted here -->
            </div>
            
            <div id="feedback-container" class="mt-6 p-4 rounded-lg hidden preserve-whitespace">
                <h3 class="font-bold text-lg mb-2">Explanation</h3>
                <p id="explanation-text"></p>
            </div>

            <button id="next-btn" class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-300 dark:focus:ring-indigo-800 hidden">Next Question</button>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 dark:text-white mb-4">Quiz Complete!</h1>
            <p class="text-lg text-gray-600 dark:text-gray-300 mb-2">You scored:</p>
            <p id="score-text" class="text-5xl font-extrabold text-indigo-600 dark:text-indigo-400 mb-8"></p>
            <p id="score-message" class="text-gray-600 dark:text-gray-300 mb-8"></p>
            <button id="restart-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-300 dark:focus:ring-indigo-800">Try Again</button>
        </div>
        
        <!-- Loading and Error States -->
        <div id="loading-state" class="text-center hidden">
             <p class="text-gray-600 dark:text-gray-300">Loading quiz...</p>
        </div>
        <div id="error-state" class="text-center hidden">
             <p class="text-red-500">Error: Could not load quiz.json. Please make sure the file exists and is correctly formatted.</p>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startScreen = document.getElementById('start-screen');
            const quizScreen = document.getElementById('quiz-screen');
            const resultsScreen = document.getElementById('results-screen');

            const startBtn = document.getElementById('start-btn');
            const nextBtn = document.getElementById('next-btn');
            const restartBtn = document.getElementById('restart-btn');

            const questionNumberEl = document.getElementById('question-number');
            const totalQuestionsEl = document.getElementById('total-questions');
            const questionTextEl = document.getElementById('question-text');
            const optionsContainer = document.getElementById('options-container');
            
            const feedbackContainer = document.getElementById('feedback-container');
            const explanationTextEl = document.getElementById('explanation-text');

            const scoreTextEl = document.getElementById('score-text');
            const scoreMessageEl = document.getElementById('score-message');
            
            const loadingState = document.getElementById('loading-state');
            const errorState = document.getElementById('error-state');
            const quizContainer = document.getElementById('quiz-container');

            let questions = [];
            let currentQuestionIndex = 0;
            let score = 0;

            // --- Function to fetch quiz data ---
            async function loadQuizData() {
                startScreen.classList.add('hidden');
                loadingState.classList.remove('hidden');
                errorState.classList.add('hidden');

                try {
                    const response = await fetch('quiz.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    questions = data;
                    
                    if (questions.length > 0) {
                        startQuiz();
                    } else {
                        throw new Error("No questions found in quiz.json");
                    }

                } catch (error) {
                    console.error("Failed to load quiz data:", error);
                    loadingState.classList.add('hidden');
                    errorState.classList.remove('hidden');
                }
            }
            
            // --- Event Listeners ---
            startBtn.addEventListener('click', loadQuizData);
            nextBtn.addEventListener('click', showNextQuestion);
            restartBtn.addEventListener('click', () => {
                resultsScreen.classList.add('hidden');
                startScreen.classList.remove('hidden');
                quizContainer.classList.remove('w-full', 'max-w-2xl');
                quizContainer.classList.add('max-w-xl');
            });


            function startQuiz() {
                loadingState.classList.add('hidden');
                quizScreen.classList.remove('hidden');
                score = 0;
                currentQuestionIndex = 0;
                totalQuestionsEl.textContent = questions.length;
                showQuestion();
            }

            function showQuestion() {
                resetState();
                const question = questions[currentQuestionIndex];
                questionNumberEl.textContent = currentQuestionIndex + 1;
                questionTextEl.textContent = question.question;

                question.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.classList.add('w-full', 'text-left', 'p-4', 'border', 'border-gray-300', 'dark:border-gray-600', 'rounded-lg', 'hover:bg-gray-100', 'dark:hover:bg-gray-700', 'transition-colors', 'focus:outline-none', 'focus:ring-2', 'focus:ring-indigo-500', 'dark:text-gray-200');
                    button.addEventListener('click', selectAnswer);
                    optionsContainer.appendChild(button);
                });
            }
            
            function resetState() {
                nextBtn.classList.add('hidden');
                feedbackContainer.classList.add('hidden');
                while (optionsContainer.firstChild) {
                    optionsContainer.removeChild(optionsContainer.firstChild);
                }
            }

            function selectAnswer(e) {
                const selectedBtn = e.target;
                const correctAnswer = questions[currentQuestionIndex].answer;
                const isCorrect = selectedBtn.textContent === correctAnswer;

                if (isCorrect) {
                    score++;
                    selectedBtn.classList.remove('border-gray-300', 'dark:border-gray-600', 'hover:bg-gray-100', 'dark:hover:bg-gray-700');
                    selectedBtn.classList.add('bg-green-100', 'dark:bg-green-900', 'border-green-500', 'dark:border-green-400', 'text-green-800', 'dark:text-green-200');
                } else {
                    selectedBtn.classList.remove('border-gray-300', 'dark:border-gray-600', 'hover:bg-gray-100', 'dark:hover:bg-gray-700');
                    selectedBtn.classList.add('bg-red-100', 'dark:bg-red-900', 'border-red-500', 'dark:border-red-400', 'text-red-800', 'dark:text-red-200');
                }
                
                showFeedbackAndCorrectAnswer();

                // Disable all options after selection
                Array.from(optionsContainer.children).forEach(button => {
                    button.disabled = true;
                });
                
                if (questions.length > currentQuestionIndex + 1) {
                    nextBtn.classList.remove('hidden');
                } else {
                    // This is the last question, show results button
                    nextBtn.textContent = 'Show Results';
                    nextBtn.classList.remove('hidden');
                    nextBtn.onclick = showResults; // Change click handler
                }
            }
            
            function showFeedbackAndCorrectAnswer() {
                 const currentQuestion = questions[currentQuestionIndex];
                 Array.from(optionsContainer.children).forEach(button => {
                    // Highlight the correct answer if it wasn't the one picked
                    if (button.textContent === currentQuestion.answer) {
                        button.classList.remove('border-gray-300', 'dark:border-gray-600', 'hover:bg-gray-100', 'dark:hover:bg-gray-700', 'bg-red-100', 'dark:bg-red-900');
                        button.classList.add('bg-green-100', 'dark:bg-green-900', 'border-green-500', 'dark:border-green-400', 'text-green-800', 'dark:text-green-200');
                    }
                });

                if (currentQuestion.explanation) {
                    explanationTextEl.textContent = currentQuestion.explanation;
                    feedbackContainer.classList.remove('hidden');
                    feedbackContainer.classList.add('bg-gray-50', 'dark:bg-gray-700');
                }
            }

            function showNextQuestion() {
                currentQuestionIndex++;
                showQuestion();
            }
            
            function showResults() {
                quizScreen.classList.add('hidden');
                resultsScreen.classList.remove('hidden');
                
                const percentage = Math.round((score / questions.length) * 100);
                scoreTextEl.textContent = `${percentage}%`;
                
                let message = '';
                if (percentage === 100) {
                    message = "Perfect Score! You're a true master!";
                } else if (percentage >= 75) {
                    message = "Great job! You know your stuff.";
                } else if (percentage >= 50) {
                    message = "Not bad, but there's room for improvement.";
                } else {
                    message = "Keep practicing! You'll get there.";
                }
                scoreMessageEl.textContent = message;
                
                // Reset next button for restart
                nextBtn.textContent = 'Next Question';
                nextBtn.onclick = showNextQuestion;
            }
        });
    </script>

</body>
</html>

